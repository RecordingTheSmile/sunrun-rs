import{e as L,r as m,n as N,o as c,c as l,a as g,b as s,w as n,d as _,F as k,j as v,t as w,m as i,B}from"./index-58cfc890.js";import{b as D,c as T}from"./index-8d6bd7cb.js";import"./index-1e23f2bc.js";import"./index-c5bb681f.js";import"./index-3445d9df.js";import{_ as A}from"./index-aeaec39b.js";import{_ as V}from"./index-f05548f4.js";import{r as h}from"./index-bdc86ed8.js";import{_ as F}from"./_plugin-vue_export-helper-c27b6911.js";import"./useMergedState-fab5ab96.js";import"./eagerComputed-6007be16.js";import"./collapseMotion-b9e096c6.js";import"./css-aae66f86.js";import"./LeftOutlined-6c91474c.js";import"./index-92a01f8e.js";import"./useFlexGapSupport-cbdc3560.js";const j={class:"table-container"},q={style:{width:"100%","text-align":"center"}},E={style:{width:"100%"},class:"table-opr"},M={style:{width:"100%"}},O={key:0,style:{color:"green"}},$={key:1,style:{color:"red"}},G=L({__name:"SunrunTaskLogs",setup(H){const o=m(!1),t=m({current:1,pageSize:10,total:0,pageSizeOptions:["10","20","30","40","50"]}),S=(e,r,a)=>{t.value.pageSize=e.pageSize??10,t.value.current=e.current??1,u(e.current??1,e.pageSize??10)},x=[{dataIndex:"id",key:"id",title:"日志ID"},{dataIndex:"createAt",key:"createAt",title:"记录于"},{dataIndex:"description",key:"description",title:"描述"},{dataIndex:"isSuccess",key:"isSuccess",title:"是否成功"},{dataIndex:"nickName",key:"nickName",title:"用户名"},{dataIndex:"schoolName",key:"schoolName",title:"学校名"}],f=m(),u=(e,r)=>(o.value=!0,h.get("/task/api/taskLog",{params:{page:e,limit:r}}).then(a=>{a.data.success?(t.value.total=a.data.data.total,f.value=a.data.data.rows):i.error(a.data.message??"请求数据失败，请刷新表格重试")}).catch(a=>{console.error(a),i.error("网络错误，请刷新表格重试")}).finally(()=>{o.value=!1})),z=()=>(o.value=!0,h.delete("/task/api/taskLog").then(e=>{if(o.value=!1,e.data.success)return i.success("删除成功"),u(t.value.current,t.value.pageSize);i.error(e.data.message??"删除任务日志失败，请重试")}).catch(e=>{o.value=!1,console.error(e),i.error("网络错误，请重试")}));return N(()=>{u(t.value.current,t.value.pageSize)}),(e,r)=>{const a=V,y=B,I=D,b=A,C=T;return c(),l("div",j,[g("div",q,[s(a,{level:3},{default:n(()=>[_("阳光体育任务日志")]),_:1})]),g("div",E,[s(b,{size:8},{default:n(()=>[s(y,{type:"primary",loading:o.value,onClick:r[0]||(r[0]=d=>u(t.value.current,t.value.pageSize))},{default:n(()=>[_("刷新表格")]),_:1},8,["loading"]),s(I,{title:"您确定要清空所有日志吗？","ok-text":"是的","cancel-text":"取消",onConfirm:z},{default:n(()=>[s(y,{type:"primary",loading:o.value,danger:""},{default:n(()=>[_("清空所有日志")]),_:1},8,["loading"])]),_:1})]),_:1})]),g("div",M,[s(C,{loading:o.value,columns:x,"data-source":f.value,scroll:{x:!0},pagination:t.value,onChange:S},{bodyCell:n(({column:d,record:p})=>[d.key==="isSuccess"?(c(),l(k,{key:0},[p.isSuccess?(c(),l("span",O,"成功")):v("",!0),p.isSuccess?v("",!0):(c(),l("span",$,"失败"))],64)):d.key==="createAt"?(c(),l(k,{key:1},[_(w(new Date(p.createAt*1e3).toLocaleString()),1)],64)):v("",!0)]),_:1},8,["loading","data-source","pagination"])])])}}});const re=F(G,[["__scopeId","data-v-2c303e2d"]]);export{re as default};
